# 产品需求文档 (PRD) v2.0：WeFinance Copilot

> **项目名称**：WeFinance Copilot (AI驱动的智能财务助理)
> **目标赛事**：2025深圳国际金融科技大赛（人工智能赛道）
> **文档版本**：2.0（基于混合OCR架构优化）
> **更新日期**：2025年11月6日
> **截止日期**：2025年11月16日 24:00（10天开发周期）

---

## 1. 项目概述

### 1.1 项目愿景

WeFinance Copilot是一个"AI原生"的智能财务助理，深度嵌入数字银行APP核心体验层。通过**图像识别OCR + 生成式AI**，我们将复杂的纸质/电子账单转化为可对话、可预测、可解释的"私人CFO"，实现从"被动记账"到"主动式财务健康管理"的飞跃。

**核心创新点**：
1. **混合OCR架构**（PaddleOCR + GPT-4o）：用户直接拍照上传账单图片，系统自动识别并结构化
2. **对话式财务顾问**：用自然语言问"我这个月还能花多少钱？"，AI结合账单数据回答
3. **可解释AI (XAI)**：所有理财建议都有"为什么？"按钮，透明展示决策逻辑
4. **主动式异常检测**：自动发现异常支出并主动提醒

### 1.2 核心问题（用户痛点）

| 痛点 | 现状 | WeFinance Copilot解决方案 |
|------|------|--------------------------|
| **账单录入繁琐** | 手动输入每笔消费，费时费力 | **图片OCR识别**：拍照即可自动提取交易记录 |
| **金融术语晦涩** | 传统理财推荐充满专业术语 | **对话式问答**："人话"翻译复杂概念 |
| **决策不透明** | 不知道为什么推荐某个理财产品 | **XAI可解释性**：展示推荐背后的逻辑链 |
| **被动式服务** | 用户必须主动查询才能发现问题 | **主动异常检测**：自动推送高风险消费提醒 |

---

## 2. 战略定位与竞赛目标

### 2.1 竞赛评分标准对应策略

| 评分维度 | 权重 | WeFinance Copilot核心对策 | 预期得分 |
|---------|------|--------------------------|---------|
| **产品实现完整性** | 40% | F1+F2+F3完整实现，F4作为加分项 | 36/40 |
| **创新性** | 30% | 混合OCR架构（成本优化97%）+ XAI可解释性 | 26/30 |
| **商业价值** | 30% | 解决真实痛点（账单OCR），可商业化落地 | 26/30 |
| **总分** | 100% | - | **88/100** |

### 2.2 技术创新亮点

**混合OCR架构成本优化**：
- **传统方案**（纯GPT-4o Vision）：100张图片 ≈ 30元人民币
- **混合方案**（PaddleOCR + GPT-4o文本处理）：100张图片 ≈ 1元人民币
- **成本降低**：97%（30元 → 1元）
- **准确率保持**：中文OCR 90%+（PaddleOCR 2.7+）

---

## 3. 目标用户画像

### P0 用户群体

**1. 金融新手（大学生/职场新人）**
- **特征**：对理财概念模糊，希望开始储蓄但无从下手
- **痛点**：看不懂金融术语，害怕风险，手动记账太繁琐
- **需求**：
  - 拍照上传账单即可自动分类
  - 用"人话"解释理财建议
  - 简单、安全、可理解的投资入门方案

**2. 繁忙的专业人士（白领/创业者）**
- **特征**：收入稳定，但没时间管理复杂财务
- **痛点**：预算工具耗时，容易忘记账单，需要"一站式"自动管理
- **需求**：
  - 自动账单分类和总结
  - 智能预算提醒
  - 主动异常支出警示

---

## 4. 功能需求（Functional Requirements）

### 4.1 P0功能（MVP核心）

#### F1：智能账单分析器（图像OCR识别）

**用户故事**：
作为一个繁忙的用户，我希望通过拍照上传账单图片，系统自动识别并生成消费分析报告，而不需要手动输入每笔交易。

**详细需求**：

1. **图像上传**
   - 支持拍照/相册上传账单图片（PNG/JPG/JPEG格式）
   - 支持批量上传（单次最多10张）
   - 图片大小限制：单张 ≤ 5MB

2. **OCR文字识别**（混合架构）
   - **第一阶段**：PaddleOCR 2.7+ 本地识别
     - 提取文字内容、坐标、置信度
     - 中文识别准确率 ≥ 90%
     - 处理时间：单张 ≤ 2秒
   - **第二阶段**：GPT-4o结构化处理
     - 输入：PaddleOCR提取的纯文本
     - 输出：JSON格式交易记录
     ```json
     {
       "transactions": [
         {
           "date": "2025-11-01",
           "merchant": "星巴克",
           "category": "餐饮",
           "amount": 45.00,
           "payment_method": "微信支付"
         }
       ]
     }
     ```

3. **智能分类**
   - 自动分类：餐饮、交通、购物、医疗、娱乐、投资、其他
   - 支持用户手动修正分类

4. **消费分析报告**
   - **月度/周度总结**："您本月在'外卖'上的支出比上月增加了30%"
   - **可视化图表**：饼图（分类占比）、折线图（趋势分析）
   - **关键洞察**：高亮异常支出、支出Top3类别

**技术实现**：
- OCR引擎：PaddleOCR 2.7+（免费、本地部署）
- 结构化处理：GPT-4o API（仅处理文本，成本低）
- 图表库：Plotly或Matplotlib

**验收标准**：
- [ ] 用户上传账单图片后3秒内完成识别
- [ ] OCR文字识别准确率 ≥ 90%
- [ ] GPT-4o结构化成功率 ≥ 95%
- [ ] 自动分类准确率 ≥ 85%

---

#### F2：对话式财务顾问

**用户故事**：
作为一个理财新手，我希望用自然语言提问"我这个月还能花多少钱？"，AI能结合我的账单数据给出个性化回答。

**详细需求**：

1. **自然语言问答**
   - 支持的问题类型：
     - 预算查询："我这个月还能花多少？"
     - 消费分析："我最近在哪方面花钱最多？"
     - 术语解释："什么是ETF？"
     - 理财建议："我该如何存钱买车？"

2. **上下文理解**
   - 记忆对话历史（会话级别，session_state）
   - 结合F1账单数据提供个性化回答
   - 示例对话：
     ```
     用户："我这个月还能花多少钱？"
     AI："您本月预算剩余500元。主要支出在餐饮（1200元）和交通（800元）。建议控制外卖频率，本月还剩15天。"
     ```

3. **响应格式**
   - **简洁模式**：直接回答（适合快速查询）
   - **详细模式**：附带数据图表和建议（适合深度分析）

**技术实现**：
- LLM：GPT-4o API（通过中转服务）
- 对话管理：LangChain（Context Memory）
- Prompt工程：Few-shot + RAG（检索账单数据）

**验收标准**：
- [ ] 问答响应时间 ≤ 3秒
- [ ] 能正确引用账单数据（引用准确率 ≥ 90%）
- [ ] 术语解释通俗易懂（用户测试满意度 ≥ 4/5星）

---

#### F3：可解释的理财建议（XAI Lite）

**用户故事**：
作为一个保守型投资者,我希望AI推荐理财产品时，能清楚告诉我"为什么推荐这个？"，而不是黑盒决策。

**详细需求**：

1. **风险偏好问卷**
   - 3道简单问题评估风险承受能力
   - 输出：保守型/稳健型/激进型

2. **投资目标输入**
   - 自由文本输入："我想存一笔买车的钱"
   - 提取关键信息：目标金额、时间期限

3. **资产配置建议**
   - 输出示例：
     ```
     建议配置方案：
     - 债券基金（A基金）：70%
     - 混合理财（B产品）：30%
     预期年化收益：4.5%
     ```

4. **XAI解释模块**（核心创新）
   - **"为什么？"按钮**：点击后展开决策逻辑
   - 解释示例：
     ```
     为什么推荐这个组合？

     1. 您的风险偏好是"保守型"
        → 优先选择低风险债券（波动率<5%）

     2. 您的目标是"1年内存5万买车"
        → 需要流动性好的产品（随时可赎回）

     3. A基金历史数据：
        - 近3年年化收益：4.2%
        - 最大回撤：-2.1%（符合保守要求）

     4. B产品补充：
        - 30%配置提高收益潜力
        - 仍在可接受风险范围内
     ```

5. **可视化**
   - 风险收益矩阵图
   - 配置饼图
   - 历史回测曲线

**技术实现**：
- 规则引擎：基于风险偏好映射产品池
- LLM生成解释：GPT-4o（Prompt包含决策规则）
- 可视化：Plotly交互图表

**验收标准**：
- [ ] 所有推荐必须有XAI解释
- [ ] 解释包含至少3个决策因子
- [ ] 用户理解度测试 ≥ 4.5/5星

---

### 4.2 P1功能（加分项）

#### F4：主动式异常检测

**用户故事**：
作为一个粗心的用户，我希望系统自动发现异常支出（如深夜大额消费），并主动提醒我，而不是等我查账时才发现。

**详细需求**：

1. **异常检测规则**
   - **金额异常**：单笔消费 > 历史均值 + 2倍标准差
   - **时间异常**：深夜22:00-6:00的大额消费（> 500元）
   - **地点异常**：异地消费（如果账单包含地理信息）
   - **频率异常**：同一商户单日消费 > 3次

2. **主动推送**
   - **卡片提醒**：在Streamlit首页顶部显示红色警告卡片
   - 示例：
     ```
     ⚠️ 异常支出提醒
     2025-11-05 23:45 | 某KTV | 1200元
     这笔消费比您平时高出300%，且发生在深夜。
     [确认是本人消费] [标记为欺诈]
     ```

3. **用户反馈闭环**
   - 用户确认后更新异常检测模型
   - 误报率 < 10%

**技术实现**：
- 统计模型：Z-score异常检测
- 轻量级规则引擎（无需复杂ML）

**验收标准**：
- [ ] 异常检测准确率 ≥ 85%
- [ ] 响应时间 < 1秒（实时检测）
- [ ] 误报率 < 10%

---

## 5. 非功能需求（Non-Functional Requirements）

| ID | 类别 | 需求描述 | 验收标准 |
|----|------|---------|---------|
| **NFR-1** | **可解释性** | 所有AI建议必须可溯源，提供决策逻辑链 | 100%功能覆盖XAI解释 |
| **NFR-2** | **隐私安全** | OCR识别在本地完成，仅传输结构化数据到GPT-4o | 零原始图片上传到云端 |
| **NFR-3** | **性能** | 图片OCR识别 ≤ 3秒，对话响应 ≤ 3秒 | 95%请求满足要求 |
| **NFR-4** | **可用性** | Demo现场演示流畅，无崩溃 | 压力测试通过（100次操作） |
| **NFR-5** | **可行性** | 10天开发周期内交付可演示原型 | 按时提交 |

---

## 6. 技术栈选型

### 6.1 核心技术栈

| 类别 | 技术选型 | 版本 | 选择理由 |
|------|---------|------|---------|
| **前端框架** | Streamlit | 1.28+ | 快速原型开发，无需前端经验 |
| **后端架构** | Python Monolithic | 3.10+ | 简化架构，无需FastAPI（Demo级别） |
| **OCR引擎** | PaddleOCR | 2.7+ | 免费、高精度中文识别、本地部署 |
| **LLM服务** | GPT-4o API | - | 通过中转API调用，成本可控 |
| **对话管理** | LangChain | 0.1+ | Context记忆、Prompt工程 |
| **数据处理** | Pandas | 2.0+ | 账单数据分析和转换 |
| **可视化** | Plotly | 5.18+ | 交互式图表，用户体验好 |
| **数据存储** | st.session_state | - | 会话级别，无需数据库 |

### 6.2 混合OCR架构流程

```
用户上传图片
    ↓
PaddleOCR本地识别（2秒）
    ↓
提取文本 + 坐标 + 置信度
    ↓
GPT-4o结构化处理（1秒）
    ↓
输出JSON格式交易记录
    ↓
保存到st.session_state
```

**成本对比**：
- 纯GPT-4o Vision：0.30元/张 × 100张 = 30元
- 混合方案：0.01元/张 × 100张 = 1元
- **节省97%成本**

### 6.3 数据流设计

```
┌─────────────┐
│ 用户上传图片 │
└──────┬──────┘
       │
       v
┌─────────────────┐
│  PaddleOCR识别  │ (本地处理，隐私保护)
└──────┬──────────┘
       │ 纯文本
       v
┌──────────────────┐
│ GPT-4o结构化处理 │ (云端API，仅传输文本)
└──────┬───────────┘
       │ JSON数据
       v
┌──────────────────┐
│ st.session_state │ (会话存储)
└──────┬───────────┘
       │
       ├──> F1 智能分析
       ├──> F2 对话问答
       ├──> F3 理财建议
       └──> F4 异常检测
```

---

## 7. 项目里程碑

| 阶段 | 时间 | 交付物 | 负责人 |
|------|------|--------|--------|
| **Phase 1** | Day 1-2 | PRD精炼（本文档） | PO Agent |
| **Phase 2** | Day 2-3 | 系统架构设计文档 | Architect Agent |
| **Phase 3** | Day 3-4 | Sprint规划与任务分解 | Scrum Master |
| **Phase 4** | Day 4-8 | 功能开发（F1-F4） | Codex Developer |
| **Phase 5** | Day 9-10 | 集成测试与Demo优化 | QA + PO |

**当前进度**：Phase 1 完成 → 进入 Phase 2（架构设计）

---

## 8. 成功指标

### 8.1 竞赛评分预测

| 维度 | 细分指标 | 得分预测 | 依据 |
|------|---------|---------|------|
| **产品完整性** (40%) | F1+F2+F3完整实现 | 36/40 | 核心功能全覆盖，F4作为加分 |
| **创新性** (30%) | 混合OCR架构 + XAI | 26/30 | 成本优化97% + 透明决策 |
| **商业价值** (30%) | 解决真实痛点 | 26/30 | 可商业化落地（银行APP集成） |
| **总分** | - | **88/100** | 预计进入决赛 |

### 8.2 技术指标

- OCR识别准确率：≥ 90%
- 结构化成功率：≥ 95%
- 对话响应时间：≤ 3秒
- 异常检测准确率：≥ 85%
- 系统可用性：≥ 99%（Demo期间）

### 8.3 用户体验指标

- 任务完成率：≥ 95%（用户能顺利完成账单上传→分析→问答流程）
- XAI理解度：≥ 4.5/5星（用户能理解推荐逻辑）
- 整体满意度：≥ 4/5星

---

## 9. 风险与应对

| 风险 | 影响 | 概率 | 应对策略 |
|------|------|------|---------|
| **PaddleOCR精度不足** | 中 | 低 | 预训练中文模型已验证，备用EasyOCR |
| **GPT-4o API限流** | 高 | 中 | 使用中转API，设置重试机制 |
| **开发时间不足** | 高 | 中 | 优先P0功能，F4作为可选项 |
| **Demo现场网络问题** | 高 | 低 | 准备离线演示视频和本地Mock数据 |

---

## 10. 附录

### 10.1 参考资料

1. 2025深圳国际金融科技大赛官网：http://www.sifisc.com
2. PaddleOCR官方文档：https://github.com/PaddlePaddle/PaddleOCR
3. GPT-4o API文档：https://platform.openai.com/docs
4. LangChain文档：https://python.langchain.com/docs

### 10.2 术语表

- **OCR**：Optical Character Recognition，光学字符识别
- **XAI**：Explainable AI，可解释人工智能
- **LLM**：Large Language Model，大语言模型
- **RAG**：Retrieval-Augmented Generation，检索增强生成
- **MVP**：Minimum Viable Product，最小可行产品

---

**文档状态**：✅ 已审核通过，进入架构设计阶段
**下一步**：生成系统架构设计文档 (02-system-architecture.md)
